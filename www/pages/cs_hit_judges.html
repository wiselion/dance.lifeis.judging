<template>
        <!-- Page, data-name contains page name which can be used in page callbacks -->
        <div class="page" data-name="judges">
          <!-- Top Navbar -->
          <div class="navbar">
            <div class="navbar-inner">
				<div class="left">
					<a href="#" class="link back">
						<i class="icon icon-back"></i>
						<span class="ios-only">Back</span>
					</a>
				</div>
				<div class="title sliding" style="padding-top:3px;"><img src="images/svg/logo.svg" style="height:34px; width:120px;"></div>
				<div class="right">
					<span class="connection-status badge{{#if offline}} color-red{{/if}}">N</span>
					<a href="#" class="link icon-only panel-open" data-panel="right">
						<i class="icon f7-icons ios-only">menu</i>
						<i class="icon material-icons md-only">menu</i>
					</a>
				</div>
            </div>
          </div>

			<!-- Scrollable page content-->
			<div class="page-content">
			
			<div class="block-title">{{title}}</div>
			<div class="tape-items">
				<div class="list links-list"><ul>
				{{#each cat.judges}}
					<li><a @click="checkPin({{../hit_id}},{{../final}},{{@key}})">{{this}}</a></li>
				{{/each}}
				</ul></div>
			</div>

          </div>
        </div>
</template>
<script>
  return {
    data() {
      return {
        // empty initial user data
        title: tour_cats[this.$route.params.hitId+'-'+this.$route.params.final].title+'<br/>'+tour_cats[this.$route.params.hitId+'-'+this.$route.params.final].final_type+'<br/>'+tour_cats[this.$route.params.hitId+'-'+this.$route.params.final].desc,
        hit_id: this.$route.params.hitId,
        final: this.$route.params.final,
        cat: tour_cats[this.$route.params.hitId+'-'+this.$route.params.final],
        offline: offline,
        //cat: tour_cats[this.$route.params.this.$route.params.],
        /*cats: tour_cats,
        lastid: tour_cats_last,
        lng:lang.mess,*/
        //allowInfinite: true,
        //testval: function(e) {console.log('get new vals in cs_categories');console.log(e); return 'xxx';}
      }
    },
    /*on: {
      pageInit() {
        var self = this;
        console.log(this.$route.params);
      },
    },*/
    methods: {
	    // WAS href="/hit/{{../hit_id}}/{{../final}}/{{@key}}/"
	    checkPin(hid,fin,jid) {
		    var jpin = '';
		    if(this.cat.judges_pins!==undefined) if(this.cat.judges_pins[jid]!==undefined) jpin = this.cat.judges_pins[jid];
			if(jpin) app.dialog.prompt('Введите Ваш ПИН код',this.cat.judges[jid],function(pin){
				if(pin==jpin) app.router.navigate('/hit/'+hid+'/'+fin+'/'+jid+'/');
				else var toastCenter = app.toast.create({
					text: 'Неверный ПИН код!',
					position: 'center',
					closeTimeout: 2000,
				}).open();});
			else app.router.navigate('/hit/'+hid+'/'+fin+'/'+jid+'/');
	    },
      saveDance: function () {
        $app.dialog.alert('Dance saved!');
      },
    }
  };
</script>